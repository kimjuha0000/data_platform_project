# Dockerfile

# 1. 베이스 이미지 선택: 어떤 환경에서 시작할지 지정합니다.
#    가볍고 효율적인 공식 파이썬 3.9 버전을 사용합니다.
FROM python:3.11-slim

# 2. 작업 디렉토리 설정: 컨테이너 내부에서 명령어를 실행할 기본 폴더를 지정합니다.
WORKDIR /app

# 3. 의존성 파일 복사: 먼저 라이브러리 목록 파일만 컨테이너 안으로 복사합니다.
#    (코드가 바뀌지 않고 라이브러리만 그대로일 경우, 도커는 이 단계를 캐싱하여 빌드 속도를 높입니다.)
COPY ./requirements.txt .

# 4. 의존성 설치: 복사한 파일을 이용해 컨테이너 내부에 라이브러리를 설치합니다.
RUN pip install --no-cache-dir -r requirements.txt

# 5. 프로젝트 전체 코드 복사: 라이브러리 설치 후, 나머지 모든 코드를 컨테이너 안으로 복사합니다.
COPY . .

# 6. 컨테이너가 시작될 때 실행할 명령어:
#    이 컨테이너가 실행되면 uvicorn 서버를 시작하라는 의미입니다.
#    '0.0.0.0'은 컨테이너 외부의 모든 IP 주소에서의 접속을 허용하겠다는 뜻으로, 매우 중요합니다.
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]